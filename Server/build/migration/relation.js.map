{"version":3,"sources":["../src/migration/relation.ts"],"names":[],"mappings":";;AAAA,sDAAqD;AACrD,uDAAiD;AAOpC,QAAA,cAAc,GAAG;IAC1B,OAAO,EAAE,gCAAgC;IACzC,GAAG,EAAE,6DAA6D;IAClE,oBAAoB,EAAE,KAAK;IAC3B,IAAI,EAAE,QAAQ;IACd,OAAO,EAAE,uBAAuB;IAChC,UAAU,EAAE;QACR,IAAI,EAAE;YACF,OAAO,EAAE,sCAAsC;YAC/C,OAAO,EAAE,gBAAQ;YACjB,IAAI,EAAE,QAAQ;SACjB;QACD,EAAE,EAAE;YACA,OAAO,EAAE,qCAAqC;YAC9C,OAAO,EAAE,gBAAQ;YACjB,IAAI,EAAE,QAAQ;SACjB;KACJ;IACD,QAAQ,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC;CAC3B,CAAA;AAED,MAAa,kBAAkB;IAG3B,YAA6B,MAAc;QAAd,WAAM,GAAN,MAAM,CAAQ;QAFlC,aAAQ,GAAgB,EAAE,CAAA;IAEW,CAAC;IAE/C,OAAO,CAAC,GAAQ;QACZ,MAAM,QAAQ,GAAc;YACxB,IAAI,EAAE,GAAG,CAAC,SAAS;YACnB,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;SACvB,CAAA;QAED,MAAM,MAAM,GAAG,qBAAQ,CAAC,QAAQ,EAAE,sBAAc,CAAC,CAAA;QAEjD,IAAI,MAAM,EAAE;YACR,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAA;SAC1C;QAED,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;IAChC,CAAC;IAED,OAAO;QACH,OAAO,OAAO,CAAC,OAAO,CAAO,SAAS,CAAC,CAAA;IAC3C,CAAC;CACJ;AAvBD,gDAuBC","file":"relation.js","sourcesContent":["import { uniqueId } from '../database/entities/utils'\nimport { validate } from '../database/validation'\n\nexport interface IRelation {\n    from: string\n    to: string\n}\n\nexport const RelationSchema = {\n    $schema: 'http://json-schema.org/schema#',\n    $id: 'http://psimarron.net/schemas/movie-db/migrate/relation.json',\n    additionalProperties: false,\n    type: 'object',\n    message: 'Verweis unvollständig',\n    properties: {\n        from: {\n            message: 'Quellkennung fehlt oder ist ungültig',\n            pattern: uniqueId,\n            type: 'string',\n        },\n        to: {\n            message: 'Zielkennung fehlt oder ist ungültig',\n            pattern: uniqueId,\n            type: 'string',\n        },\n    },\n    required: ['from', 'to'],\n}\n\nexport class RelationCollection {\n    readonly migrated: IRelation[] = []\n\n    constructor(private readonly _other: string) {}\n\n    fromSql(sql: any): void {\n        const relation: IRelation = {\n            from: sql.Recording,\n            to: sql[this._other],\n        }\n\n        const errors = validate(relation, RelationSchema)\n\n        if (errors) {\n            throw new Error(JSON.stringify(errors))\n        }\n\n        this.migrated.push(relation)\n    }\n\n    migrate(): Promise<void> {\n        return Promise.resolve<void>(undefined)\n    }\n}\n"],"sourceRoot":"/home/jochenmanns/Software/git/MovieDBNode/Server/build"}