{"version":3,"sources":["../src/migration/link.ts"],"names":[],"mappings":";;AAAA,sDAAqD;AACrD,uDAAiD;AAYpC,QAAA,UAAU,GAAG;IACtB,OAAO,EAAE,gCAAgC;IACzC,GAAG,EAAE,yDAAyD;IAC9D,oBAAoB,EAAE,KAAK;IAC3B,IAAI,EAAE,QAAQ;IACd,OAAO,EAAE,uBAAuB;IAChC,UAAU,EAAE;QACR,QAAiB,EAAE;YACf,OAAO,EAAE,sCAAsC;YAC/C,OAAO,EAAE,gBAAQ;YACjB,IAAI,EAAE,QAAQ;SACjB;QACD,MAAe,EAAE;YACb,OAAO,EAAE,qCAAqC;YAC9C,OAAO,EAAE,gBAAQ;YACjB,IAAI,EAAE,QAAQ;SACjB;KACJ;IACD,QAAQ,EAAE,cAAgC;CAC7C,CAAA;AAED,MAAa,cAAc;IAGvB,YAA6B,MAAc;QAAd,WAAM,GAAN,MAAM,CAAQ;QAF1B,cAAS,GAAY,EAAE,CAAA;IAEM,CAAC;IAE/C,OAAO,CAAC,GAAQ;QACZ,MAAM,IAAI,GAAU;YAChB,IAAI,EAAE,GAAG,CAAC,SAAS;YACnB,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;SACvB,CAAA;QAED,MAAM,MAAM,GAAG,qBAAQ,CAAC,IAAI,EAAE,kBAAU,CAAC,CAAA;QAEzC,IAAI,MAAM,EAAE;YACR,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAA;SAC1C;QAED,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;IAC7B,CAAC;CACJ;AAnBD,wCAmBC","file":"link.js","sourcesContent":["import { uniqueId } from '../database/entities/utils'\nimport { validate } from '../database/validation'\n\nconst enum LinkFields {\n    from = 'from',\n    to = 'to',\n}\n\nexport interface ILink {\n    [LinkFields.from]: string\n    [LinkFields.to]: string\n}\n\nexport const LinkSchema = {\n    $schema: 'http://json-schema.org/schema#',\n    $id: 'http://psimarron.net/schemas/movie-db/migrate/link.json',\n    additionalProperties: false,\n    type: 'object',\n    message: 'Verweis unvollständig',\n    properties: {\n        [LinkFields.from]: {\n            message: 'Quellkennung fehlt oder ist ungültig',\n            pattern: uniqueId,\n            type: 'string',\n        },\n        [LinkFields.to]: {\n            message: 'Zielkennung fehlt oder ist ungültig',\n            pattern: uniqueId,\n            type: 'string',\n        },\n    },\n    required: [LinkFields.from, LinkFields.to],\n}\n\nexport class LinkCollection {\n    private readonly _migrated: ILink[] = []\n\n    constructor(private readonly _other: string) {}\n\n    fromSql(sql: any): void {\n        const link: ILink = {\n            from: sql.Recording,\n            to: sql[this._other],\n        }\n\n        const errors = validate(link, LinkSchema)\n\n        if (errors) {\n            throw new Error(JSON.stringify(errors))\n        }\n\n        this._migrated.push(link)\n    }\n}\n"],"sourceRoot":"/home/jochenmanns/Software/git/MovieDBNode/Server/build"}