{"version":3,"sources":["../src/migration/links.ts"],"names":[],"mappings":";;AAAA,+BAAiC;AAEjC,qDAA2D;AAC3D,6CAAkD;AAClD,uDAAiD;AAQpC,QAAA,cAAc,GAAG,IAAI,CAAC,KAAM,SAAQ,sBAAqB;IAAnC;;QACtB,SAAI,GAAG,KAAK,CAAA;QAEZ,WAAM,GAAG,sBAAU,CAAA;IA2BhC,CAAC;IAzBG,OAAO,CAAC,GAAQ;QACZ,MAAM,IAAI,GAAU;YAChB,GAAG,EAAE,SAAI,EAAE;YACX,GAAG,EAAE,GAAG,CAAC,GAAG;YACZ,IAAI,EAAE,GAAG,CAAC,IAAI,IAAI,EAAE;YACpB,OAAO,EAAE,QAAQ,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC;YAClC,GAAG,EAAE,GAAG,CAAC,GAAG;SACf,CAAA;QAED,IAAI,GAAG,CAAC,WAAW,EAAE;YACjB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,WAAW,CAAA;SACrC;QAED,MAAM,MAAM,GAAG,qBAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,CAAA;QAE1C,IAAI,MAAM,EAAE;YACR,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAA;SAC1C;QAED,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;IAC5B,CAAC;IAED,OAAO;QACH,OAAO,OAAO,CAAC,OAAO,CAAO,SAAS,CAAC,CAAA;IAC3C,CAAC;CACJ,CAAC,EAAE,CAAA","file":"links.js","sourcesContent":["import { v4 as uuid } from 'uuid'\n\nimport { IDbLink, LinkSchema } from '../database/recording'\nimport { CollectionBase } from '../database/utils'\nimport { validate } from '../database/validation'\n\nexport interface ILink extends IDbLink {\n    _id: string\n    for: string\n    ordinal: number\n}\n\nexport const linkCollection = new (class extends CollectionBase<ILink> {\n    readonly name = 'n/a'\n\n    readonly schema = LinkSchema\n\n    fromSql(sql: any): void {\n        const link: ILink = {\n            _id: uuid(),\n            for: sql.For,\n            name: sql.Name || '',\n            ordinal: parseInt(sql.Ordinal, 10),\n            url: sql.Url,\n        }\n\n        if (sql.Description) {\n            link.description = sql.Description\n        }\n\n        const errors = validate(link, this.schema)\n\n        if (errors) {\n            throw new Error(JSON.stringify(errors))\n        }\n\n        this.cacheMigrated(link)\n    }\n\n    migrate(): Promise<void> {\n        return Promise.resolve<void>(undefined)\n    }\n})()\n"],"sourceRoot":"/home/jochenmanns/Software/git/MovieDBNode/Server/build"}